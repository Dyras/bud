---
sidebar_label: '@roots/bud-postcss'
---

import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

# @roots/bud-postcss

[PostCSS](https://postcss.org) support can be added by installing the **@roots/bud-postcss** extension.

## Installation

<Tabs
  defaultValue="yarn"
  values={[
    {label: 'yarn', value: 'yarn'},
    {label: 'npm', value: 'npm'},
  ]}>
  <TabItem value="yarn">

    yarn add @roots/bud-postcss --dev

  </TabItem>
  <TabItem value="npm">

    npm install @roots/bud-postcss --save-dev

  </TabItem>
</Tabs>

## Installing peer dependencies

After installing the main package, run the `bud init` command to install required peer dependencies:

<Tabs
  defaultValue="yarn"
  values={[
    {label: 'yarn', value: 'yarn'},
    {label: 'npm', value: 'npm'},
  ]}>
  <TabItem value="yarn">

    yarn bud init

  </TabItem>
  <TabItem value="npm">

    npm run bud init

  </TabItem>
</Tabs>

## Usage

Add the extension to your config:

```js
bud.use(require('@roots/bud-postcss'))
```

You should be good-to-go at this point! If you feel you may need to configure postcss further, read on.

## Configuration

Out of the box **@roots/bud-postcss** supports:

- postcss-import
- postcss-nested
- postcss-preset-env

If this works for you, great! No need to keep reading. But, should you need something more specialized, you can configure it in your bud config file or a **postcss.config.js** file in your project's root directory.

:::info

If you have a postcss config file in your project, that configuration will be used instead of the defaults provided by this extension.

:::

## Using the bud config builder

The API used by **@roots/bud-postcss** internally can also be used in your project config. Here are the defaults expressed in a few different ways:

```js
bud.postcss.setPlugins({
  'postcss-import',
  ['postcss-preset-env', {stage: 1}],
})
```

```js
bud.postcss
  .setPlugin('postcss-import')
  .setPlugin(['postcss-preset-env', {stage: 1}])
```

```js
bud.postcss
  .setPlugin(['postcss-import'])
  .setPlugin(['postcss-preset-env'])
  .setPluginOptions('postcss-preset-env', {stage: 1})
```

### postcss.setPlugin

Add a postcss plugin. Takes two parameters: the first is the resolvable plugin module name, The second are any options to pass to the PostCSS plugin function it references.

```js
bud.postcss.setPlugin(['postcss-preset-env', {stage: 1}])
```

If there are no options you can use a string:

```js
bud.postcss.setPlugin('postcss-preset-env')
```

### postcss.setPlugins

Adds postcss plugins. Takes an array of the arguments supplied to **bud.postcss.setPlugin**.

```js
bud.postcss.setPlugins([
  'postcss-import',
  ['postcss-preset-env', {stage: 1}],
])
```

### postcss.unsetPlugin

Remove a postcss plugin:

```js
bud.postcss.unsetPlugin('postcss-import')
```

### postcss.setPluginOptions

Override any plugin options:

```js
bud.postcss.setPluginOptions('postcss-import', {
  path: bud.filter('build/resolve/modules'),
})
```
