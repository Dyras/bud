/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-kjo",
factory: function (require) {
var plugin=(()=>{var O=Object.create,c=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var q=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var M=e=>c(e,"__esModule",{value:!0});var o=e=>{if(typeof require!="undefined")return require(e);throw new Error('Dynamic require of "'+e+'" is not supported')};var S=(e,t)=>{for(var s in t)c(e,s,{get:t[s],enumerable:!0})},_=(e,t,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of q(t))!I.call(e,a)&&a!=="default"&&c(e,a,{get:()=>t[a],enumerable:!(s=A(t,a))||s.enumerable});return e},r=e=>_(M(c(e!=null?O(F(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var T={};S(T,{default:()=>R});var w=r(o("@yarnpkg/cli")),j=r(o("@yarnpkg/core")),v=r(o("@yarnpkg/shell")),$=1,m=0,i=class extends w.BaseCommand{async getManifest(){return await j.Manifest.tryFind(this.context.cwd)}async $(t){let s;return Array.isArray(t)?s=await t.reduce(this.sequential.bind(this),this.promiseOK()):s=await this.runTask(t),this.taskFailed(s)&&process.exit($),Promise.resolve(m)}async sequential(t,s){let a=await t;return this.taskFailed(a)?$:this.$(s)}runTask(t){let[s,...a]=t.split(" ");return(0,v.execute)(s,a)}taskFailed(t){return Array.isArray(t)?t.filter(s=>s!==m).length>0:t!==m}async promiseOK(){return m}};i.usage={category:"kjo"};var y=r(o("clipanion")),p=class extends i{constructor(){super(...arguments);this.cjs=y.Option.Boolean("-c,--cjs",!1);this.esm=y.Option.Boolean("-e,--esm",!1);this.commands={all:"yarn workspaces foreach --topological-dev --no-private --exclude @roots/bud-typings -i -p -v run build",cjs:"yarn workspaces foreach --topological-dev --no-private --exclude @roots/bud-typings -i -p -v run build:cjs",esm:"yarn workspaces foreach --topological-dev --no-private --exclude @roots/bud-typings -i -p -v run build:esm"}}async execute(){let t=[];this.cjs&&t.push(this.commands.cjs),this.esm&&t.push(this.commands.esm),!this.cjs&&!this.esm&&t.push(this.commands.all),await this.$(t)}};p.paths=[["kjo","build"]];var C=r(o("clipanion")),u=class extends i{constructor(){super(...arguments);this.dfx=C.Option.Boolean("-d,--dfx",!1)}async execute(){if(this.dfx){await this.$("git clean -dfx"),await this.$("yarn cache clean");return}console.log("rimraf **/.budfiles"),await this.$("yarn rimraf **/.budfiles"),console.log("rimraf examples/*/node_modules"),await this.$("yarn rimraf examples/*/node_modules"),console.log("rimraf examples/*/dist"),await this.$("yarn rimraf examples/*/dist"),console.log("rimraf examples/sage/public/*"),await this.$("yarn rimraf examples/sage/public/*"),console.log("rimraf examples/sage/storage/bud/*"),await this.$("yarn rimraf examples/sage/storage/bud/*"),console.log("rimraf packages/@roots/*/lib"),await this.$("yarn rimraf packages/@roots/*/lib"),console.log("rimraf packages/@roots/*/types"),await this.$("yarn rimraf packages/@roots/*/types"),console.log("rimraf packages/@roots/*/node_modules"),await this.$("yarn rimraf packages/@roots/*/node_modules"),console.log("cache clean"),await this.$("yarn cache clean")}};u.paths=[["kjo","clean"]];var n=r(o("clipanion")),d=class extends i{constructor(){super(...arguments);this.all=n.Option.Boolean("-a,--all",!1);this.prettier=n.Option.Boolean("-p,--prettier",!1);this.eslint=n.Option.Boolean("-e,--eslint",!1);this.skypack=n.Option.Boolean("-s,--skypack",!1)}async execute(){let t=!this.prettier&&!this.skypack&&!this.eslint||this.all;(this.eslint||t)&&(await this.$("yarn eslint packages/**/src/**/*.{js,jsx,ts,tsx} --fix"),await this.$("yarn eslint dev/**/*.{js,jsx,ts,tsx} --fix")),(this.prettier||t)&&(console.log("prettier packages/**/src/**/*.{ts,js,tsx,jsx} --fix --ignore-unknown --loglevel silent --no-error-on-unmatched-pattern"),await this.$("yarn prettier packages/**/src/**/*.{ts,js,tsx,jsx} --fix --ignore-unknown --loglevel silent --no-error-on-unmatched-pattern"),console.log("prettier dev/**/*.{ts,js,tsx,jsx} --fix --ignore-unknown --loglevel silent --no-error-on-unmatched-pattern"),await this.$("yarn prettier dev/**/*.{ts,js,tsx,jsx} --fix --ignore-unknown --loglevel silent --no-error-on-unmatched-pattern"),console.log("prettier site/**/*.{ts,js,tsx,jsx,md,mdx} --fix --ignore-unknown --loglevel silent --no-error-on-unmatched-pattern"),await this.$("yarn prettier site/**/*.{ts,js,tsx,jsx,md,mdx} --fix --ignore-unknown --loglevel silent --no-error-on-unmatched-pattern")),(this.skypack||t)&&await this.$("yarn workspaces foreach --no-private --exclude @roots/bud-typings -p -v run pkg")}};d.paths=[["kjo","lint"]];var l=r(o("clipanion")),f=class extends i{constructor(){super(...arguments);this.all=l.Option.Boolean("-a,--all",!1);this.unit=l.Option.Boolean("-u,--unit",!1);this.integration=l.Option.Boolean("-i,--integration",!1);this.workers=l.Option.String("-w,--workers","50%")}async execute(){let t=!this.unit&&!this.integration||this.all;(this.unit||t)&&await this.$(`yarn jest --coverage --testPathIgnorePatterns="tests/integration" --testPathIgnorePatterns="tests/util" --maxWorkers=${this.workers}`),(this.integration||t)&&await this.$("node ./jest.integration.js")}};f.paths=[["kjo","test"]];var k=r(o("clipanion")),P=r(o("@yarnpkg/fslib")),h=class extends i{constructor(){super(...arguments);this.version=k.Option.String("-v,--version",{required:!1});this.tag=k.Option.String("-t,--tag",{required:!1})}async execute(){var s,a;let{raw:t}=await this.getManifest();t.manifest.version=(s=this.version)!=null?s:t.manifest.version,t.manifest.tag=(a=this.tag)!=null?a:t.manifest.tag,P.xfs.writeJsonSync(this.context.cwd.concat("/package.json"),t),this.version&&await this.$(`yarn workspaces foreach --no-private version --deferred ${t.manifest.version}`),!this.version&&!this.tag&&console.log(`${t.manifest.version}`)}};h.paths=[["kjo","version"]];var B=r(o("clipanion")),g=class extends i{constructor(){super(...arguments);this.dfx=B.Option.Boolean("-d,--dfx",!1)}async execute(){await this.$("yarn install --immutable"),await this.$("yarn kjo clean"),await this.$("yarn kjo build"),await this.$("yarn kjo test"),await this.$("yarn"),await this.$("yarn kjo lint")}};g.paths=[["kjo","make"]];var b=r(o("clipanion")),x=class extends i{constructor(){super(...arguments);this.site=b.Option.Boolean("-s,--site",!1);this.readme=b.Option.Boolean("-r,--readme",!1);this.commands={site:["yarn workspace @roots/bud-docs run docusaurus build"],readme:["yarn ts-node ./dev/readme"]}}async execute(){let t=[];this.readme&&t.push(this.commands.readme),this.site&&t.push(this.commands.site),!this.site&&!this.readme&&t.push(Object.values(this.commands).reduce((s,a)=>[...s,...a]),[]),await this.$(t)}};x.paths=[["kjo","gen"]];var K={hooks:{afterAllInstalled:()=>{console.log("What a great install, am I right?")}},commands:[p,u,d,g,x,f,h]},R=K;return T;})();
return plugin;
}
};
